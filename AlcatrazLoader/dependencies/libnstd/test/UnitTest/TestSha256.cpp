
#include <nstd/Crypto/Sha256.hpp>
#include <nstd/Debug.hpp>

void testSha256()
{
  byte check1[Sha256::digestSize] = {
    0xe3, 0xb0, 0xc4, 0x42, 0x98, 0xfc, 0x1c, 0x14, 0x9a, 0xfb, 0xf4, 0xc8, 0x99, 0x6f, 0xb9, 0x24, 0x27, 0xae, 0x41, 0xe4, 0x64, 0x9b, 0x93, 0x4c, 0xa4, 0x95, 0x99, 0x1b, 0x78, 0x52, 0xb8, 0x55
  };
  byte checksum[Sha256::digestSize];
  Sha256::hash((const byte*)"", 0, checksum);
  ASSERT(Memory::compare(checksum, check1, sizeof(check1)) == 0);
  byte check2[Sha256::digestSize] = {
    0x5c, 0x93, 0x0f, 0xbe, 0x6a, 0x4d, 0x8d, 0x87, 0xd8, 0x98, 0x5b, 0x2d, 0x28, 0xad, 0x6b, 0x30, 0xa9, 0xba, 0x93, 0xfb, 0x05, 0x7e, 0x14, 0x9c, 0x96, 0xca, 0x82, 0x6d, 0xe7, 0x7a, 0x50, 0xa8
  };
  Sha256::hash((const byte*)"But First, We Need to Talk About Parallel Universes", 51, checksum);
  ASSERT(Memory::compare(checksum, check2, sizeof(check2)) == 0);
}

int main(int argc, char* argv[])
{
  testSha256();
  return 0;
}
